<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="/css/head.css">
  <link rel="stylesheet" href="/css/middle.css">
  <link rel="stylesheet" href="/css/command.css">
  <link rel="stylesheet" href="/css/bottom.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <title>购物车</title>
</head>
<body>
<div class="head">
  <div class="left">
    <a href="/shouye">
      <img src="/img/屏幕截图%202025-04-06%20165050.png" alt="">
      <img src="/img/屏幕截图%202025-04-06%20165121.png" alt="">
    </a>

  </div>

  <div class="right">
    <nav style="--bs-breadcrumb-divider: '｜';" aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a style="color: #111111" href="#">关于我们</a></li>
        <li class="breadcrumb-item" id="userSection">
                        <span th:if="${session.user != null}">
                            欢迎，<span th:text="${session.user.username}"></span>
                            <a href="/logout" style="color: #111111; margin-left: 10px;">退出</a>
                        </span>
        </li>
      </ol>
    </nav>
  </div>
</div>
<div class="head2">
  <div class="head-left">
    <img src="/img.png" alt="">
  </div>
  <div class="head-middle">
    <a th:href="@{/products(category='新品')}">新品&潮流</a>
    <a th:href="@{/products(category='男子')}">男子</a>
    <a th:href="@{/products(category='女子')}">女子</a>
    <a th:href="@{/products(category='儿童')}">儿童</a>
  </div>
  <div class="head-right">
    <form class="d-flex" role="search" th:action="@{/search}" method="get">
      <input class="form-control me-2" type="search" name="keyword" placeholder="搜索球衣" aria-label="Search">
      <button class="btn btn-light" type="submit">搜索</button>
    </form>
  </div>
</div>
<div class="container d-flex flex-wrap justify-content-between align-items-start p-3">
  <!-- 商品列表区域 -->
  <div class="cart-items" style="width: 60%; min-width: 300px;">
    <div th:each="item : ${cartItems}" class="card mb-3" style="max-width: 100%;">
      <div class="row g-0 h-100">
        <!-- 图片区域 - 固定宽高比 -->
        <div class="col-md-4 position-relative" style="min-height: 150px; aspect-ratio: 1/1;">
          <img th:src="${item.product.imageUrl}"
               class="img-fluid rounded-start h-100 w-100 object-fit-cover"
               th:alt="${item.product.name}"
               style="position: absolute; top: 0; left: 0;">
        </div>

        <!-- 商品信息区域 -->
        <div class="col-md-8 d-flex flex-column">
          <div class="card-body d-flex flex-column h-100 p-3">
            <h5 class="card-title mb-2" th:text="${item.product.name}">商品名</h5>
            <p class="card-text flex-grow-1 mb-2 small"
               th:text="${item.product.description}"
               style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
              商品介绍
            </p>
            <div class="mb-2">
              <span class="badge bg-light text-dark me-2" th:text="'尺码: ' + ${item.size}">尺码</span>
              <span class="badge bg-light text-dark me-2" th:text="'数量: ' + ${item.quantity}">数量</span>
              <span class="badge bg-light text-dark" th:text="'¥' + ${item.price}">价格</span>
            </div>
            <div class="mt-auto text-end">
              <button class="btn btn-outline-danger btn-sm remove-item"
                      th:data-id="${item.id}"
                      style="width: 80px;">
                删除
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 摘要区域 -->
  <div class="summary-card sticky-top" style="width: 35%; min-width: 300px; top: 20px;">
    <div class="card shadow-sm">
      <div class="card-body">
        <h3 class="card-title text-center mb-4">订单摘要</h3>

        <div class="d-flex justify-content-between mb-3">
          <span class="text-muted">商品小计</span>
          <span th:text="'¥' + ${#numbers.formatDecimal(total, 1, 2)}">¥0.00</span>
        </div>

        <div class="d-flex justify-content-between mb-3">
          <span class="text-muted">运费</span>
          <span>¥0.00</span>
        </div>

        <hr>

        <div class="d-flex justify-content-between mb-4">
          <h5>总计</h5>
          <h5 th:text="'¥' + ${#numbers.formatDecimal(total, 1, 2)}">¥0.00</h5>
        </div>

        <button class="btn btn-dark w-100 mb-2 py-2">前往结算</button>
        <button class="btn btn-outline-danger w-100 py-2" id="clearCart">清空购物车</button>
      </div>
    </div>
  </div>
</div>

<script>
$(document).ready(function() {
    // 删除购物车项
    $('.remove-item').click(function() {
        const itemId = $(this).data('id');
        $.ajax({
            url: '/cart/remove/' + itemId,
            type: 'GET',
            success: function(response) {
                alert(response);
                location.reload();
            },
            error: function() {
                alert('删除失败，请重试');
            }
        });
    });

    // 清空购物车
    $('#clearCart').click(function() {
        if (confirm('确定要清空购物车吗？')) {
            $.ajax({
                url: '/cart/clear',
                type: 'GET',
                success: function(response) {
                    alert(response);
                    location.reload();
                },
                error: function() {
                    alert('清空失败，请重试');
                }
            });
        }
    });
});
</script>

<hr style="border: solid #ccc; margin: 20px 0;">
<div class="bottom">
  <div class="a1">
    <div class="aa1">
      <h4 style="margin-left: 1em">获取礼品卡</h4>
      <ul>
        <li><a href="#">关于我们</a></li>
        <li><a href="#">关于我们</a></li>
        <li><a href="#">关于我们</a></li>
      </ul>
    </div>
    <div class="aa1">
      <h4 style="margin-left: 1em">获取帮助</h4>
      <ul>
        <li><a href="#">关于我们</a></li>
        <li><a href="#">关于我们</a></li>
        <li><a href="#">关于我们</a></li>
      </ul>
    </div>
    <div class="aa1">
      <h4 style="margin-left: 1em">关于我们</h4>
      <ul>
        <li><a href="#">加入我们</a></li>
        <li><a href="#">关于我们</a></li>
        <li><a href="#">关于我们</a></li>
      </ul>
    </div>
  </div>
  <div class="a2">
    <p><small>
      @纪子涵2025 Allright.reserve
    </small>
    </p>
    <p>
      地址：哈尔滨理工大学西区七公寓
    </p>

  </div>

</div>


</body>
</html>