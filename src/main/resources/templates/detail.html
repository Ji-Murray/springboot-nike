<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:text="${product.name}">商品详情</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/head.css(v=1.0)}">
  <link rel="stylesheet" th:href="@{/css/detail.css(v=1.0)}">
  <link rel="stylesheet" th:href="@{/css/bottom.css(v=1.0)}">
  <link rel="stylesheet" th:href="@{/css/command.css(v=1.0)}">
  <link rel="stylesheet" th:href="@{/css/goumai.css(v=1.0)}">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<div class="head">
  <div class="left">
    <img src="/img/屏幕截图%202025-04-06%20165050.png" alt="">
    <img src="/img/屏幕截图%202025-04-06%20165121.png" alt="">
  </div>

  <div class="right">
    <nav style="--bs-breadcrumb-divider: '｜';" aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a style="color: #111111" href="#">关于我们</a></li>
        <li class="breadcrumb-item" id="userSection">
                        <span th:if="${session.user != null}">
                            欢迎，<span th:text="${session.user.username}"></span>
                            <a href="/logout" style="color: #111111; margin-left: 10px;">退出</a>
                        </span>
        </li>
      </ol>
    </nav>
  </div>
</div>
<div class="head2">
  <div class="head-left">
    <img src="/img/img.png" alt="">
  </div>
  <div class="head-middle">
    <a href="@{/products(category='新品')}">新品&潮流</a>
    <a href="@{/products(category='男子')}">男子</a>
    <a href="@{/products(category='女子')}">女子</a>
    <a href="@{/products(category='儿童')}">儿童</a>
  </div>
  <div class="head-right">
    <form class="d-flex" role="search">
      <input class="form-control me-2" type="search" placeholder="搜索球衣" aria-label="Search">
      <button class="btn btn-light" type="submit">搜索</button>
    </form>
  </div>
</div>
<div class="shouhou">
  <div class="word-left">
    <p> <strong> 售后无忧温馨提示 </strong></p>
  </div>
  <div class="word-right">
    <p><small>如需退换货，请先提交退换货申请</small></p>
  </div>
</div>
<div class="neirong">
  <div class='neirong-left'>
      <img th:src="${product.imageUrl}" class="img-thumbnail" th:alt="${product.name}">
      <img th:src="${product.imageUrl}" class="img-thumbnail" th:alt="${product.name}">
      <img th:src="${product.imageUrl}" class="img-thumbnail" th:alt="${product.name}">
      <img th:src="${product.imageUrl}" class="img-thumbnail" th:alt="${product.name}">
  </div>
  <div class="neirong-right">
    <div class="zi">
      <p class="h1" th:text="${product.name}">商品名称</p>
      <p class="h3" th:text="${product.description}">商品描述</p>
      <p class="h6 text-danger" th:text="'¥' + ${product.price}">商品价格</p>
    </div>
    <div class="choice">
      <div class="zi1">
        <p><strong>选择尺码</strong></p>
        <p style="margin-right: 5px;">尺码表</p>
      </div>

      <div class="container ">
        <div class="row row-cols-3 g-4" > <!-- 明确3列 + 统一间距 -->
          <!-- 9个按钮示例 -->
          <div class="col">
            <button type="button" class="btn btn-light size-btn" data-size="S(US 40)">S(US 40)</button>
          </div>
          <div class="col">
            <button type="button" class="btn btn-light size-btn" data-size="M(US 44)">M(US 44)</button>
          </div>
          <div class="col">
            <button type="button" class="btn btn-light size-btn" data-size="L(US 48)">L(US 48)</button>
          </div>
          <!-- 更多按钮... -->
        </div>
        <div class="row row-cols-3 g-4" > <!-- 明确3列 + 统一间距 -->
          <!-- 9个按钮示例 -->
          <div class="col">
            <button type="button" class="btn btn-light size-btn" data-size="XL(US 52)">XL(US 52)</button>
          </div>
          <div class="col">
            <button type="button" class="btn btn-light size-btn" data-size="XXL(US 56)">XXL(US 56)</button>
          </div>
          <div class="col">
            <button type="button" class="btn btn-light size-btn" data-size="3XL(US 58)">3XL(US 58)</button>
          </div>
          <!-- 更多按钮... -->
        </div>
        <div class="row row-cols-3 g-4"> <!-- 明确3列 + 统一间距 -->
          <!-- 9个按钮示例 -->
          <div class="col">
            <button type="button" class="btn btn-light size-btn" data-size="M(US 44)">M(US 44)</button>
          </div>
          <div class="col">
            <button type="button" class="btn btn-light size-btn" data-size="M(US 44)">M(US 44)</button>
          </div>
          <div class="col">
            <button type="button" class="btn btn-light size-btn" data-size="M(US 44)">M(US 44)</button>
          </div>
          <!-- 更多按钮... -->
        </div>
      </div>

    </div>
    <div class="anniu">
      <div class="jiaru">
        <button type="button" class="btn btn-primary btn-lg btn-dark" id="buyNowBtn">立即购买</button>
      </div>
      <div class="goumai">
        <button type="button" class="btn btn-primary btn-lg btn-light" id="addToCartBtn">加入购物车</button>
      </div>
    </div>



  </div>
</div>

<hr style="border: solid #ccc; margin: 20px 0;">
<div class="bottom">
  <div class="a1">
    <div class="aa1">
      <h4 style="margin-left: 1em">获取礼品卡</h4>
      <ul>
        <li><a href="#">关于我们</a></li>
        <li><a href="#">关于我们</a></li>
        <li><a href="#">关于我们</a></li>
      </ul>
    </div>
    <div class="aa1">
      <h4 style="margin-left: 1em">获取帮助</h4>
      <ul>
        <li><a href="#">关于我们</a></li>
        <li><a href="#">关于我们</a></li>
        <li><a href="#">关于我们</a></li>
      </ul>
    </div>
    <div class="aa1">
      <h4 style="margin-left: 1em">关于我们</h4>
      <ul>
        <li><a href="#">加入我们</a></li>
        <li><a href="#">关于我们</a></li>
        <li><a href="#">关于我们</a></li>
      </ul>
    </div>
  </div>
  <div class="a2">
    <p><small>
      @纪子涵2025 Allright.reserve
    </small>
    </p>
    <p>
      地址：哈尔滨理工大学西区七公寓
    </p>

  </div>

</div>

<script th:inline="javascript">
$(document).ready(function() {
    let selectedSize = '';
    const productId = [[${product.id}]];
    
    // 尺码选择
    $('.size-btn').click(function() {
        $('.size-btn').removeClass('active');
        $(this).addClass('active');
        selectedSize = $(this).data('size');
    });
    
    // 加入购物车
    $('#addToCartBtn').click(function() {
        if (!selectedSize) {
            alert('请选择尺码');
            return;
        }
        
        $.ajax({
            url: '/cart/add',
            type: 'GET',
            data: {
                productId: productId,
                size: selectedSize,
                quantity: 1
            },
            success: function(response) {
                alert(response);
                if (response === '请先登录') {
                    window.location.href = '/login';
                }
            },
            error: function(xhr, status, error) {
                console.error('Error:', error);
                alert('添加失败，请重试');
            }
        });
    });

    // 立即购买
    $('#buyNowBtn').click(function() {
        if (!selectedSize) {
            alert('请选择尺码');
            return;
        }
        
        $.ajax({
            url: '/orderlist/create',
            type: 'GET',
            data: {
                productId: productId,
                size: selectedSize,
                quantity: 1
            },
            success: function(response) {
                alert(response);
                if (response === '请先登录') {
                    window.location.href = '/login';
                } else if (response === '订单创建成功') {
                    window.location.href = '/orderlist';
                }
            },
            error: function(xhr, status, error) {
                console.error('Error:', error);
                alert('购买失败，请重试');
            }
        });
    });
});
</script>
</body>
</html>